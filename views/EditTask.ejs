
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title><%= title %></title>
  <link rel="stylesheet" href="/static/styles.css" />
  <script>
    function isoToLocal(iso) {
      if (!iso) return '';
      const d = new Date(iso);
      const pad = n => String(n).padStart(2,'0');
      return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}T${pad(d.getHours())}:${pad(d.getMinutes())}`;
    }
    window.addEventListener('DOMContentLoaded', () => {
      const inp = document.querySelector('input[name="dueDate"]');
      inp.value = isoToLocal("<%= task.dueDate || '' %>");
    });
  </script>
</head>
<body>
<nav class="nav">
  <div class="brand">Scheduler</div>
  <div class="spacer"></div>
  <a class="link" href="/dashboard">Back</a>
</nav>

<main class="container narrow">
  <% if (flash) { %><div class="alert <%= flash.type %>"><%= flash.message %></div><% } %>
  <h2>Edit Task</h2>
  <form method="POST" action="/tasks/<%= task.id %>?_method=PUT">
    <label>Title <input name="title" value="<%= task.title %>" required></label>
    <label>Description <textarea name="description" rows="3"><%= task.description %></textarea></label>
    <label>Due Date <input type="datetime-local" name="dueDate"></label>
    <label>Priority
      <select name="priority">
        <option value="high" <%= task.priority==='high'?'selected':'' %>>High</option>
        <option value="medium" <%= task.priority==='medium'?'selected':'' %>>Medium</option>
        <option value="low" <%= task.priority==='low'?'selected':'' %>>Low</option>
      </select>
    </label>
    <button class="btn primary" type="submit">Save Changes</button>
  </form>
</main>
</body>
</html>
